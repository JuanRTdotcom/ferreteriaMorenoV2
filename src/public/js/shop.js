let _database=[],_colours=[],_headings=[],_brands=[],_dataLocal=[];function ajax(){const e=new XMLHttpRequest;e.onreadystatechange=function(){if(4==this.readyState&&200==this.status){let e=this.response;_database=JSON.parse(e)._misDatosBD,_colours=JSON.parse(e).coloresUnicos,_headings=JSON.parse(e).rubrosUnicos,_brands=JSON.parse(e).lineasUnicos,_codigoColores=JSON.parse(e).codigoColores,_dataLocal=_database,document.getElementById("elementosencontrados").innerHTML=_database.length;let t=document.getElementById("_setColours"),n=document.getElementById("_setHeading"),o=document.getElementById("_setBrands"),a=0;_colours.forEach(e=>{let n=document.createElement("div");n.setAttribute("style","margin: 0 5px 0 0;"),n.innerHTML=`\n                         \n                                    <div onclick="filtroColor('${e}')" for="white" style="font-size: 18px;text-decoration: none;cursor: pointer;color:black;">\n                                    <i class="fa fa-circle" style="color:${_codigoColores[a]};"> </i> \n                                    \n                                        </div>\n                                    \n                                        `,t.appendChild(n),a++}),_headings.forEach(e=>{let t=_database.filter(t=>t.rubro==e),o=document.createElement("li");o.setAttribute("style","display:flex;justify-content:space-between;padding:10px 0 0;border-bottom: 1px #e4e4e4cf solid;"),o.innerHTML=`\n                    <div onclick="filtroRubro('${e}')" style="font-size: 12px;text-decoration: none;cursor: pointer;color:black;">${e}</div>\n                    <div style="font-size: 12px">${t.length}</div>\n                    `,n.appendChild(o)}),_brands.forEach(e=>{let t=_database.filter(t=>t.linea==e),n=document.createElement("li");n.setAttribute("style","display:flex;justify-content:space-between;padding:10px 0 0;border-bottom: 1px #e4e4e4cf solid;"),n.innerHTML=`\n                    <div onclick="filtroMarca('${e}')" style="font-size: 12px;text-decoration: none;cursor: pointer;color:black;">${e}</div>\n                    <div style="font-size: 12px">${t.length}</div>\n                    `,o.appendChild(n)}),crearPaginacion(_database,_database.length)}},e.open("GET","/catalogo-online/getData"),e.send()}ajax();let crearPaginacion=(e,t)=>{document.getElementById("elementosencontrados").innerHTML=e.length;let n=Math.ceil(t/16);$("#pagination-demo").twbsPagination({totalPages:n,visiblePages:5,onPageClick:function(t,n){let o=document.getElementById("_setProductos");o.innerHTML="";let a=16*n-16,i=16*n-1;buscarProductos(e),llenarProductos(e,a,i,o)}})},buscarProductos=e=>{e.map(function(e){return e.nombre}).filter(unique)},llenarProductos=(e,t,n,o)=>{for(let a=t;a<=n;a++)if(e[a]){let t=document.createElement("div");t.setAttribute("class","col-lg-3 col-md-6 col-sm-4 col-6 _productos"),t.setAttribute("style","background:white;border-top: 6px #F3F3F3 solid;transition:.3s;border-right: 3px #F3F3F3 solid;border-bottom: 0;border-left: 3px #F3F3F3 solid;border-radius:10px"),t.innerHTML=`\n            <div class="product__item">\n            <div class="product__item__text">\n                <h5 style="font-size: 12px;text-align: left;font-weight: 900;">${e[a].linea}</h5>\n                <h6 style="font-size: 14px;text-align: left;font-weight: 400;">${e[a].nombre}</h6>\n                <h6 style="font-size: 14px;text-align: left;font-weight: 400;color:#EA593F">S/. ${e[a].precio}</h6>\n            </div>\n            <div class="product__item__pic set-bg" style="background: url('${e[a].imagenURL}')center;background-size: contain;background-repeat: no-repeat;">\n                <ul class="product__item__pic__hover">\n                    <li><a><i class="fa fa-heart"></i></a></li>\n                </ul>\n            </div>\n            \n        </div>\n            `,o.appendChild(t)}},filtroColor=e=>{$("#pagination-demo").twbsPagination("destroy");let t=_database.filter(t=>t.color==e);_dataLocal=t,crearPaginacion(t,t.length)},filtroRubro=e=>{$("#pagination-demo").twbsPagination("destroy");let t=_database.filter(t=>t.rubro==e);_dataLocal=t,crearPaginacion(t,t.length)},filtroMarca=e=>{$("#pagination-demo").twbsPagination("destroy");let t=_database.filter(t=>t.linea==e);_dataLocal=t,crearPaginacion(t,t.length)},setOrden=()=>{switch(document.getElementById("orderpor").value){case"mayor":var e=_dataLocal.sort(function(e,t){return t.precio-e.precio});$("#pagination-demo").twbsPagination("destroy"),crearPaginacion(e,e.length);break;case"menor":e=_dataLocal.sort(function(e,t){return e.precio-t.precio});$("#pagination-demo").twbsPagination("destroy"),crearPaginacion(e,e.length)}};const unique=(e,t,n)=>n.indexOf(e)===t;document.getElementById("buscarConsulta").addEventListener("submit",e=>{e.preventDefault();let t=document.getElementById("clienteVentas").value,n=_dataLocal.filter(e=>e.nombre.toLowerCase().includes(t.toLowerCase()));n.length>0&&($("#pagination-demo").twbsPagination("destroy"),crearPaginacion(n,n.length))});let leerDat=()=>{""==document.getElementById("clienteVentas").value&&($("#pagination-demo").twbsPagination("destroy"),crearPaginacion(_dataLocal,_dataLocal.length))};